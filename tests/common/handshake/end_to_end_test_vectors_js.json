{
  "_metadata": {
    "version": "0.9",
    "generated_by": "FoxWhisper End-to-End Test Vector Generator (JavaScript)",
    "description": "Complete protocol flow test vectors for FoxWhisper E2EE",
    "test_categories": [
      "handshake_flow"
    ],
    "validation_features": [
      "message_structure_validation",
      "field_size_validation",
      "base64_encoding_validation",
      "chronological_validation",
      "session_consistency_validation"
    ]
  },
  "handshake_flow": {
    "description": "Complete FoxWhisper handshake flow",
    "participants": [
      "client",
      "server"
    ],
    "steps": [
      {
        "step": 1,
        "type": "HANDSHAKE_INIT",
        "from": "client",
        "to": "server",
        "message": {
          "type": "HANDSHAKE_INIT",
          "version": 1,
          "client_id": "v3r7Cg7TvyYW6qCgBw+yBOIFgDbQ31wqErgyvOno+hM=",
          "x25519_public_key": "lpAeZwp0GlQfKID7zHtur+BLQmwjUGYfuOC2yNB8+5E=",
          "kyber_public_key": "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",
          "timestamp": 1701763200000,
          "nonce": "unR+bsA3RJRuTKCwSHdEmQ=="
        },
        "expected_response": "HANDSHAKE_RESPONSE"
      },
      {
        "step": 2,
        "type": "HANDSHAKE_RESPONSE",
        "from": "server",
        "to": "client",
        "message": {
          "type": "HANDSHAKE_RESPONSE",
          "version": 1,
          "server_id": "9U+kmU9XP0bJOnrNPCBaBI1h5XumZGTFDQ5c7T79+Jw=",
          "x25519_public_key": "OyGyLmHW1w4Ah9gYY6SJjWRYypBWD6gaNGzkC+LiRYs=",
          "kyber_ciphertext": "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",
          "timestamp": 1701763201000,
          "nonce": "rt2L8PBLoHMRXXDSdFVMUA=="
        },
        "expected_response": "HANDSHAKE_COMPLETE"
      },
      {
        "step": 3,
        "type": "HANDSHAKE_COMPLETE",
        "from": "client",
        "to": "server",
        "message": {
          "type": "HANDSHAKE_COMPLETE",
          "version": 1,
          "session_id": "55UeXau1vcwwB/cL2/wLpLvBwThK43z7f6pKgfUjNBg=",
          "handshake_hash": "XKOd/ogLrGPwBBDHdwYOyPYkqMrNtb1iUFBjZRH6CR4=",
          "timestamp": 1701763202000
        },
        "expected_response": "ENCRYPTED_MESSAGE"
      }
    ],
    "validation_criteria": {
      "all_required_fields_present": true,
      "correct_message_types": true,
      "valid_base64_encoding": true,
      "correct_field_sizes": true,
      "chronological_timestamps": true,
      "matching_session_ids": true
    }
  }
}