{
  "handshake_flow": {
    "description": "Complete FoxWhisper handshake flow",
    "participants": [
      "client",
      "server"
    ],
    "steps": [
      {
        "step": 1,
        "type": "HANDSHAKE_INIT",
        "from": "client",
        "to": "server",
        "message": {
          "type": "HANDSHAKE_INIT",
          "version": 1,
          "client_id": "DxCL1gntA+hCi0ZlK00suzxa0JpA+a4OXPoquhBCvb4=",
          "x25519_public_key": "OyaLpT6DgTSHTMKlLAmwxdK5bFP4YYJUUTvwIK0v2gY=",
          "kyber_public_key": "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",
          "timestamp": 1701763200000,
          "nonce": "glpp62E3xBzQxM1a9yjScA=="
        },
        "expected_response": "HANDSHAKE_RESPONSE"
      },
      {
        "step": 2,
        "type": "HANDSHAKE_RESPONSE",
        "from": "server",
        "to": "client",
        "message": {
          "type": "HANDSHAKE_RESPONSE",
          "version": 1,
          "server_id": "jdHTPNdvvLEUjwL59Pq1WNU+QJsEA2LkWgy+U/LsByc=",
          "x25519_public_key": "pzvUzwnyXHVe7MjBBw5K1h4A8GfVtsy/xf86+DqQsCU=",
          "kyber_ciphertext": "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",
          "timestamp": 1701763201000,
          "nonce": "1zKdu2hFfTpcyHy83/i9uw=="
        },
        "expected_response": "HANDSHAKE_COMPLETE"
      },
      {
        "step": 3,
        "type": "HANDSHAKE_COMPLETE",
        "from": "client",
        "to": "server",
        "message": {
          "type": "HANDSHAKE_COMPLETE",
          "version": 1,
          "session_id": "pa1Fw0wFsD0rcy3kmKbULs08c/5x88Fq4aWc2Ui0cvI=",
          "handshake_hash": "t+laezB3nb6yj/Zfyorm4CLNOjDT08gO3aGgOZNyRjc=",
          "timestamp": 1701763202000
        },
        "expected_response": "ENCRYPTED_MESSAGE"
      }
    ],
    "validation_criteria": {
      "all_required_fields_present": true,
      "correct_message_types": true,
      "valid_base64_encoding": true,
      "correct_field_sizes": true,
      "chronological_timestamps": true,
      "matching_session_ids": true
    }
  },
  "device_addition": {
    "description": "Add new device to existing FoxWhisper session",
    "scenario": "device_addition",
    "existing_session": {
      "session_id": "bdMrJ2jRezwNOyVoYN3kmNC1idvlYRV0bapVHO29UK8=",
      "devices": [
        "/NLosyW/wWiV19dW/y/KUmlQuq+l6ZRlML+ID9lIpSo="
      ]
    },
    "steps": [
      {
        "step": 1,
        "type": "DEVICE_ANNOUNCE",
        "from": "new_device",
        "to": "existing_devices",
        "message": {
          "type": "DEVICE_ANNOUNCE",
          "version": 1,
          "device_id": "YTIbVx5YhjEmoqAJP88jwBlYK07k/Ba4SW3uzdkm5XA=",
          "session_id": "bdMrJ2jRezwNOyVoYN3kmNC1idvlYRV0bapVHO29UK8=",
          "x25519_public_key": "7fxdpxE42wh9NCE8gww5yRmAh9K2ClD9WIlq/j6gKXs=",
          "timestamp": 1701763203000
        }
      },
      {
        "step": 2,
        "type": "DEVICE_ACK",
        "from": "existing_devices",
        "to": "new_device",
        "message": {
          "type": "DEVICE_ACK",
          "version": 1,
          "device_id": "/NLosyW/wWiV19dW/y/KUmlQuq+l6ZRlML+ID9lIpSo=",
          "session_id": "bdMrJ2jRezwNOyVoYN3kmNC1idvlYRV0bapVHO29UK8=",
          "existing_devices": [
            "/NLosyW/wWiV19dW/y/KUmlQuq+l6ZRlML+ID9lIpSo="
          ],
          "timestamp": 1701763204000
        }
      }
    ],
    "validation_criteria": {
      "device_authentication": true,
      "session_consistency": true,
      "no_duplicate_devices": true,
      "proper_device_ids": true
    }
  },
  "_metadata": {
    "version": "0.9",
    "generated_by": "FoxWhisper End-to-End Test Vector Generator",
    "description": "Complete protocol flow test vectors for FoxWhisper E2EE",
    "test_categories": [
      "handshake_flow",
      "device_addition"
    ],
    "validation_features": [
      "message_structure_validation",
      "field_size_validation",
      "base64_encoding_validation",
      "chronological_validation",
      "session_consistency_validation"
    ]
  }
}