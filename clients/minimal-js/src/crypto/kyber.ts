import pqclean from 'pqclean';

// Deterministic ML-KEM-1024 fixtures (pqclean), generated once for harness use.
export const KYBER_PUB_B64 =
  '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';
export const KYBER_PRIV_B64 =
  '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';
export const KYBER_CT_B64 =
  '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';
export const KYBER_SS_B64 = 'qo73W8plKCS1rASQShUm3Cp2BC2lkH03nFIFIrEuMWM=';

export function decapsulate(ciphertextB64: string, privB64: string): string {
  const KEM = (pqclean as any).KEM;
  const kem = new KEM('ml-kem-1024');
  const ct = Buffer.from(ciphertextB64, 'base64');
  const sk = Buffer.from(privB64, 'base64');
  const ss = kem.decryptKey(sk, ct);
  return Buffer.from(ss).toString('base64');
}
